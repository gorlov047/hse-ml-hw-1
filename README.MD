# Отчет по домашнему заданию №1: Предсказание цен на автомобили

## Обзор проекта
Проект по разработке модели машинного обучения для предсказания цен на подержанные автомобили на основе их характеристик.

## Обработка данных

### 1. Загрузка и предварительный анализ
- Загружены тренировочный (5840 образцов) и тестовый (1253 образца) наборы данных
- Выявлены пропуски в столбцах: engine, max_power, mileage, seats, torque
- Обнаружены дубликаты: 1159 в тренировочном наборе по фичам

### 2. Очистка данных
- Удалены полные дубликаты строк
- Преобразованы текстовые числовые признаки:
  - `mileage`, `engine`, `max_power`: извлечены числовые значения
  - `torque`: разделен на два признака (крутящий момент и обороты)
- Заполнение пропусков медианами тренировочного набора
- Обработка категориальных признаков:
  - Извлечение марки автомобиля из поля `name`
  - Объединение редких категорий

### 3. Анализ данных (EDA)
- Построены pairplot для визуализации распределений
- Анализ корреляций (Пирсон, Спирмен, phi-k)
- Выявлены сильные корреляции между признаками мощности двигателя
- Цена положительно коррелирует с годом выпуска, отрицательно - с пробегом

## Моделирование

### Реализованные модели
1. **Linear Regression (базовая)**: R² = 0.58
2. **Lasso Regression**: с GridSearchCV, 10 фолдов
3. **ElasticNet**: комбинация L1 и L2 регуляризаций
4. **Ridge Regression с категориальными признаками**: лучшая модель

### Результаты
- **Лучшая модель**: Ridge Regression с OHE-кодированием категориальных признаков
- **R² на тесте**: 0.68-0.72
- **Важнейшие признаки**: max_power (мощность), year (год выпуска)

### Особенности реализации
- Стандартизация числовых признаков
- One-Hot Encoding категориальных признаков с drop='first'
- Использование GridSearchCV для подбора гиперпараметров
- L0-регуляризация через полный перебор комбинаций признаков

## Streamlit приложение

### Функциональность
1. **Ручной ввод** характеристик автомобиля
2. **Загрузка CSV-файла** для пакетного предсказания
3. **Предобработка данных** идентичная тренировочному пайплайну

### Техническая реализация
- Сохранение модели и препроцессоров в pickle-файл
- Интеграция полного пайплайна предобработки
- Обработка ошибок и валидация входных данных

## Структура проекта
```
project/
├── hw1.ipynb              # Основной ноутбук с анализом и моделированием
├── app.py                 # Streamlit приложение
├── car_price_model.pkl    # Сохраненная модель и препроцессоры
├── requirements.txt       # Зависимости
└── README.md             # Этот файл
```

## Запуск приложения
```bash
pip install -r requirements.txt
streamlit run app.py
```

## Ключевые выводы
1. Наибольший вклад в цену вносят технические характеристики (мощность, объем двигателя)
2. Категориальные признаки (топливо, коробка передач) улучшают качество модели
3. Регуляризация помогает избежать переобучения
4. Бизнес-метрика (ошибка ≤10%) достигла 45.2%

## Ограничения и дальнейшее развитие
- Модель не учитывает региональные особенности цен
- Можно улучшить обработку текстового поля `name`
- Добавление внешних данных (инфляция, курс валют)
- Реализация ансамблевых методов для улучшения точности